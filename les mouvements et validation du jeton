function printGrid(g: Grid): void {
  console.log("-".repeat(COLS * 4 + 1));
  for (let r = 0; r < ROWS; r++) {
    let line = "|";
    for (let c = 0; c < COLS; c++) {
      const v = g[r][c];
      line += " " + (v === 0 ? "." : v.toString()) + " |";
    }
    console.log(line);
    console.log("-".repeat(COLS * 4 + 1));
  }

  let idxLine = " ";
  for (let c = 0; c < COLS; c++) idxLine += ` ${c}  `;
  console.log(idxLine);
  console.log("");
}

function isValidMove(grid: Grid, col: number): boolean {
  if (col < 0 || col >= COLS) return false;
  return grid[0][col] === 0;
}

function getAvailableRow(grid: Grid, col: number): number {
  for (let r = ROWS - 1; r >= 0; r--) {
    if (grid[r][col] === 0) return r;
  }
  return -1;
}

function dropToken(grid: Grid, col: number, player: number): number {
  const r = getAvailableRow(grid, col);
  if (r === -1) return -1;
  grid[r][col] = player;
  return r;
}
